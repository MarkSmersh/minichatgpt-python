<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script type="text/javascript" src="https://unpkg.com/commonmark@0.29.3/dist/commonmark.js"></script>
<body>
    <div id="text" class="">Text should be here <br> \[ f(x, y) = 1 - x^2 - y^2 \] <br> $f(x, y) = 1 - x^2 - y^2$</div>
</body>
<style>
    * {
        background-color: #333333 !important;
        color: white !important;
    }

    body {
        margin: 5%;
    }
</style>
<script>

    function b64DecodeUnicode(str) {
    // Going backwards: from bytestream, to percent-encoding, to original string.
        return decodeURIComponent(atob(str).split('').map(function(c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
    }

    function requestApply() {
        regex = new RegExp("(text)=([A-Za-z0-9=+'\"]*)")
        base64 = regex.exec(window.location.search)[2]

        text = b64DecodeUnicode(base64)

        console.log(base64)
        console.log(text)

        var reader = new commonmark.Parser({smart: true});
        var writer = new commonmark.HtmlRenderer({sourcepos: true});
        var parsed = reader.parse(text); // parsed is a 'Node' tree
        var result = writer.render(parsed); // result is a String

        console.log(result)

        document.getElementById("text").innerHTML = result || document.getElementById("text").innerHTML
    }

    requestApply()
</script>
</html>